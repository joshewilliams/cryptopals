package main

import (
	"cryptopals/set1/charscore"
	"cryptopals/set1/xor"
	"encoding/hex"
	"fmt"
)

func main() {
	src := "424d0f1f133c691f1c4e01071b16361e49201d43536506471c45070c120c081a11142147001d590400265337061a4101545f200a4712084e3e0945051a071f786a361d4148551b1d741e4909027a494800131a450f0d0401190b130031531507070b411679351b05464f4e4e27040c58080020080b19020e5c52691f025401070253261502024f4e30360a0906094e100810050f103b3a471c644f02534f1674060f0e434c4e2f490817151d0e45284d010755784f060b530c000a1f3a5e2e410e49566206477e08010142041e4e1c062b54171959215703533178074109594f26071313134e49040b4d061a7830001d4e541a4e4f0739523a410a005c620a12112c0d071709190b07133d2a1a1c07484f0b003d55080d184430654909194519490d164d3a11152a49011d004848161f22520c000b545b621a0854240a20060b090011102c4552064e095904173a52051865735b275b4a54004e01450b4d0f541336001b1a4e1c0026547414491807411a2d051300000c084509141a0607302a1d2743064601532007490f4f415f2b49081a45010d6f48404e1b5f784e114e4e1b4d4f1c3078064100445621452e180e4e10171c084e001d3155523d501a410e01331e1a080a505b2b060e0145270404450b0b00133c54134e4f48414f16743b0a0f1b4b1a6205471d090f0d080e4d0b5417762a3b034c03000e003a5f49001c4e4e620c0e15453a0c0016034e110b360c2b1b430654160774130e6b1a005565050c11451c0042114d0b540b2b591764561a410b1c315e19001b431a230c4711030d492711031a1d523707170f4c094541790d0705410a00552a1b4b1a45020a490b4d0711523747001d2a074e42533c1f490e434857200d4b0d101e0604094d0f542139480607571c004f033b532a0c4f4e5b261a1e1d44643f35450c0718523b00174259180048533b1b4e091d00532708151d0a64070a0c0c071301784f521a470d000616350507413c004f29491304111707450b4d07180137000007076241061f741149121c4c536508030d101e0609451f4e011b7f2a311b451f591b16321702411d00552907471d002d081c22184e390436001c4e52074948072d1c490e1c4e1a2e074735091a1b100d190b13172c000001494f54065331171a0f4f6e4d3b1c155408140d0745054e3d5237535c64730d5001533b1a1b4106455b051b06540407631117010a16523000130b000154015326070d6b07521d6206131d1500490b0803423d1f3253520b540600001d5e021b000e49160b040f1a0c491d02110105545239411b4e791d540e03301f490f0a415e0b1d0813111a08453c180313063056521a2a07530a533b1c0805034e1a27101254044e4e5c0c4d17001f7979074e19485302533100496b00075f3508021d42081a493c4c0f103b3b4e0602001c2a000136164e410a545462064b07491d4945044d0318522c2a1d0a4e1c424f12741c490e48005f310d6d37100b1d00091f0d54173747064e6344791a103a1105410a645e48064011151a010b454d0758017854020c43484e4f1d211763044f481a2b0a471b111c490649094e1c5239435201431a003c533b171c4103531a2c490853450b1a10174d3701053641101a4c484542533a06044d0e595230496d1b45061c0d45051a3d052b5713426211000054311608411d4e1a114908110a420c001c021715162b4e5206531b4e4f79355244310e0052360f090d081d0a361c4d01031b3d420b4e4f1f490a112d1549110e0052360f090d081d0a2245051a541d7447520654484f4314743e100518005462060011040a190445051a121c214d010d54040000533d5c63310e0052360f090d081d0a26084d00541d3d4f5e025405000a015e1e10150e004f2949121d45061d450a4d0154137854520f001c2a030a2013491404004f2b49471d110b0510004d01542239001a1a4606590200375201154f4f1a2d0c08582603490b45020b1b5208415206540e4e161e271163"
	high := 0
	var out string
	for i := 0; i <= 255; i++ {
		key := hex.EncodeToString([]byte(string(i)))
		result := xor.ToASCII(src, key, true, false)
		score := charscore.TotalScore(result)
		if score > high {
			high = score
			out = result
		}
	}

	fmt.Println(out)
}
